// start map
const maps = document.getElementById("map");
if(maps) {
  var myMap,ymaps;
  function init() {
    myMap = document.getElementById("map");
    if (!myMap) return;
    myMap = new ymaps.Map(myMap, {
      center: [55.753215, 37.622504],
      zoom: 9, 
      controls: []
      },{
      zoomControlPosition: { right: 0, top: 0 },
      zoomControlSize: 'auto'
    });

    // if(oldWidth <= 1200){
    //   myMap.behaviors.disable('drag');
    //   myMap.behaviors.disable('scrollZoom');
    // }

    var data = {
      'points': [{
        "infoPoint": '<div id="map__point_1" class="map__point{% if properties.active %} map__active{% endif %}">\
          <span class="map__icon"><svg width="63" height="85" viewBox="0 0 63 85" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M0 33.2016C0 51.7093 18.3338 67.8626 28.7119 82.7015C30.1799 84.8004 32.7732 84.7844 34.2294 82.7015C44.6032 67.8626 62.9371 51.7093 62.9371 33.2016C62.9371 16.9806 48.8475 0 31.4685 0C14.0895 0 0 16.9806 0 33.2016Z" fill="#0052A0"/><path d="M14.4224 36.0114V44.3088H15.8583V41.8997C16.139 42.1319 16.4482 42.2713 16.7794 42.2713C17.2539 42.2713 17.6439 42.0334 17.9501 41.5576C18.2938 41.028 18.4651 40.2462 18.4651 39.2232C18.4651 38.5094 18.3277 37.8671 18.0595 37.3199L18.0126 37.2304L17.9656 37.1562L17.9341 37.082L17.8872 37.0225L17.8402 36.9483L17.7778 36.874L17.7309 36.8145L17.6839 36.7551L17.6215 36.6956L17.5745 36.6361L17.5121 36.5766L17.4497 36.5319L17.3872 36.4724L17.3248 36.4277L17.2624 36.383L17.1999 36.3382L17.122 36.3087L17.0596 36.264L16.9971 36.2345L16.9192 36.205L16.8413 36.175L16.7634 36.1451L16.6855 36.1156L16.6075 36.1008L16.5296 36.086L16.4517 36.0713L16.3583 36.0418H16.2804L16.187 36.027H16.1091L16.0152 36.0123H15.9218H14.4224V36.0114ZM15.7804 37.1862H15.9208C16.2829 37.1862 16.5641 37.3855 16.7634 37.7662C16.9632 38.1469 17.0601 38.7355 17.0601 39.5505C17.0601 39.9907 17.0036 40.3385 16.8728 40.5764C16.7479 40.8143 16.5856 40.9333 16.4048 40.9333C16.2299 40.9333 16.0861 40.8205 15.9677 40.6059C15.8494 40.398 15.7804 40.0978 15.7804 39.699V37.1862Z" fill="white"/><path d="M48.206 35.6119L48.0877 35.7247C48.0877 35.7247 45.0848 38.7105 44.8601 38.9365V36.0102H43.4556V44.3253H44.8601V40.9112C44.8975 40.8698 46.7016 39.0493 46.9079 38.8414C46.9204 39.1445 47.1137 44.3253 47.1137 44.3253H48.5497L48.206 35.6119Z" fill="white"/><path d="M41.3588 35.7252L41.3523 35.7371L41.3398 35.7428L41.3273 35.7609L41.3084 35.7785L41.2834 35.8023L41.2584 35.8261L41.2269 35.856L41.196 35.886L41.1585 35.9217L41.121 35.9636L41.0771 36.005L41.0336 36.0464L40.9897 36.094L40.9397 36.1415L40.8838 36.1948L40.7714 36.3081L40.653 36.427L40.5282 36.5522L40.3973 36.683L40.26 36.8196L40.1161 36.9562L39.9728 37.0989L39.8289 37.2478L39.5357 37.539L39.3924 37.6818L39.249 37.8188L39.1117 37.9554L38.9808 38.0924L38.85 38.2176L38.7311 38.3365L38.6187 38.4493L38.5628 38.5026L38.5128 38.5564L38.4629 38.604L38.4189 38.6515L38.3755 38.6934L38.338 38.7353L38.3005 38.7709L38.2631 38.8066L38.2321 38.8366L38.2071 38.8604L38.1822 38.8842L38.1632 38.908L38.1442 38.9199L38.1317 38.938V36.0116H36.7202V44.3267H38.1312V40.9127C38.1687 40.8713 39.9733 39.0507 40.179 38.8428C40.1915 39.1459 40.3853 44.3267 40.3853 44.3267H41.8148L41.4712 35.6119L41.3588 35.7252Z" fill="white"/><path d="M33.1908 42.2689L33.1034 42.168L33.0285 42.0671L32.9535 41.9539L32.8911 41.8411L32.8287 41.7221L32.7722 41.6032L32.7158 41.4785L32.6723 41.3534L32.6349 41.2168L32.5974 41.086L32.5659 40.9432L32.541 40.8005L32.522 40.6515L32.5095 40.5026L32.503 40.348L32.4965 40.1933C32.4965 39.3192 32.7213 38.6231 33.1583 38.1116C33.6393 37.5525 34.3386 37.2732 35.2501 37.2732H35.3185V35.8219H35.2501C33.8266 35.8219 32.7338 36.2382 31.9911 37.0766C31.3168 37.8323 30.9736 38.8848 30.9736 40.2052C30.9736 41.478 31.3482 42.5306 32.0785 43.3219C32.8526 44.1546 33.9205 44.5828 35.2691 44.5828H35.3375V43.1258H35.2691C34.3835 43.1254 33.6843 42.8399 33.1908 42.2689Z" fill="white"/><path d="M21.8998 35.8121C21.1446 35.8121 20.5417 36.2195 20.1047 37.0165C19.6801 37.8016 19.4648 38.8455 19.4648 40.1241C19.4648 41.4445 19.6676 42.5123 20.0737 43.2912C20.4858 44.0882 21.1006 44.4955 21.8998 44.4955C22.7179 44.4955 23.3637 44.0644 23.8197 43.2317C24.2443 42.4523 24.4595 41.3998 24.4595 40.1088C24.4595 38.836 24.2408 37.7949 23.8037 37.016L23.7568 36.9417L23.7098 36.8675L23.6784 36.7933L23.6159 36.7338L23.5845 36.6743L23.522 36.6149L23.4751 36.5554L23.4281 36.4959L23.3812 36.4364L23.3188 36.377L23.2718 36.3322L23.2094 36.2875L23.1624 36.2427L23.1 36.198L23.053 36.1533L22.9906 36.1086L22.9282 36.0786L22.8657 36.0491L22.8033 36.0196L22.7409 35.9901L22.6784 35.9601L22.616 35.9301L22.5536 35.9154L22.4757 35.8854L22.4132 35.8707L22.3353 35.8559L22.2729 35.8412H22.2104L22.1325 35.8264L22.0546 35.8116H21.9767H21.8998V35.8121ZM21.8998 37.1502C22.2993 37.1502 22.593 37.4209 22.7738 37.9681C22.9486 38.4615 23.0236 39.1815 23.0236 40.1093C23.0236 41.0072 22.9362 41.7538 22.7429 42.3248L22.7114 42.3843L22.6959 42.429L22.6804 42.4737L22.665 42.5184L22.6495 42.5632L22.6185 42.6079L22.603 42.6526L22.5715 42.6826L22.5561 42.7273L22.5246 42.7573L22.5091 42.802L22.4936 42.832L22.4627 42.8615L22.4312 42.891L22.4157 42.9205L22.3847 42.9353L22.3693 42.9648L22.3378 42.9943L22.3068 43.009L22.2754 43.0385L22.2439 43.0533L22.2124 43.068L22.1969 43.0828L22.1655 43.0975H22.134L22.1025 43.1123L22.0716 43.127H22.0401L22.0086 43.1418H21.9772H21.9457H21.8988C21.5556 43.1418 21.2964 42.8625 21.1026 42.3091C20.9028 41.7319 20.8059 40.9915 20.8059 40.1231C20.8059 39.2371 20.9028 38.5053 21.1026 37.9524C21.2849 37.4238 21.5501 37.1502 21.8998 37.1502Z" fill="white"/><path d="M27.7795 42.2689L27.742 42.2213L27.6981 42.168L27.6167 42.0671L27.5482 41.9539L27.4793 41.8411L27.4169 41.7221L27.3609 41.6032L27.311 41.4785L27.261 41.3534L27.2236 41.2168L27.1861 41.086L27.1611 40.9432L27.1362 40.8005L27.1177 40.6515L27.1052 40.5026L27.0927 40.348V40.1933C27.0927 39.3192 27.311 38.6231 27.7545 38.1116C28.229 37.5525 28.9283 37.2732 29.8398 37.2732H29.9147V35.8219H29.8398C28.4223 35.8219 27.3235 36.2382 26.5872 37.0766C25.9065 37.8323 25.5698 38.8848 25.5698 40.2052C25.5698 41.478 25.9379 42.5306 26.6747 43.3219C27.4423 44.1546 28.5162 44.5828 29.8653 44.5828H29.9337V43.1258H29.8653C28.9717 43.1254 28.2725 42.8399 27.7795 42.2689Z" fill="white"/><path d="M14.4375 23.8214V32.1779H16.0548V25.207H18.0527V32.1779H19.6635V23.8214H14.4375Z" fill="white"/><path d="M24.6143 23.6017C23.7587 23.6017 23.0719 24.0118 22.5854 24.8212C22.1044 25.6125 21.8672 26.6594 21.8672 27.9436C21.8672 29.2697 22.0919 30.3556 22.554 31.1407C23.022 31.9439 23.7152 32.345 24.6143 32.345C25.5318 32.345 26.256 31.9258 26.768 31.0812C27.249 30.2961 27.5017 29.2345 27.5017 27.9436C27.5017 26.6589 27.2395 25.6059 26.7525 24.8212L26.7056 24.747L26.6586 24.6728L26.6117 24.5985L26.5492 24.5391L26.5023 24.4648L26.4398 24.4053L26.3929 24.3459L26.3305 24.2864L26.268 24.2269L26.2211 24.1822L26.1586 24.1227L26.0962 24.078L26.0338 24.0333L25.9713 23.9885L25.8934 23.9438L25.831 23.9138L25.7686 23.8691L25.7061 23.8391L25.6282 23.8091L25.5658 23.7796L25.4878 23.7497L25.4099 23.7197L25.3475 23.7049L25.2696 23.675L25.1917 23.6602L25.1137 23.6455L25.0358 23.6307L24.9579 23.6159H24.864H24.7861L24.7082 23.6012H24.6143V23.6017ZM24.6303 25.0144C25.0673 25.0144 25.3765 25.2823 25.5822 25.8176C25.7696 26.3053 25.863 27.0162 25.863 27.9441C25.863 28.8301 25.7536 29.5709 25.5353 30.13C25.323 30.6772 25.0298 30.9328 24.6303 30.9328H24.5833H24.5518H24.5204H24.4894L24.4579 30.918L24.4265 30.9032H24.395L24.3635 30.8885L24.3326 30.8737L24.3011 30.859L24.2696 30.8442L24.2382 30.8295L24.2067 30.7995L24.1757 30.7848L24.1443 30.7553L24.1128 30.7405L24.0973 30.7105L24.0659 30.681L24.0344 30.6511L24.0189 30.6211L23.9874 30.5911L23.956 30.5464L23.9405 30.5164L23.909 30.4864L23.8935 30.4417L23.8626 30.397L23.8471 30.367L23.8316 30.3075L23.8001 30.2628L23.7847 30.2181L23.7692 30.1733L23.7377 30.1286C23.5194 29.5514 23.4101 28.8201 23.4101 27.9574C23.4101 27.0714 23.5194 26.3486 23.7377 25.8014C23.9465 25.2733 24.2367 25.0144 24.6303 25.0144Z" fill="white"/><path d="M36.2949 23.8214V25.207H37.637V32.1779H39.2543V25.207H40.6153V23.8214H36.2949Z" fill="white"/><path d="M32.7543 26.7302H31.8742C31.5121 26.7302 31.2374 26.6531 31.0686 26.4984C30.9437 26.3914 30.8873 26.2424 30.8873 26.0521V23.8214H29.2705V26.2067C29.2705 26.7539 29.5013 27.2236 29.9508 27.5924C30.3938 27.9554 30.9437 28.1395 31.5741 28.1395H32.7538V32.1779H34.3711V23.8214H32.7538L32.7543 26.7302Z" fill="white"/><path d="M42.72 23.8224L42.4233 32.1793H44.0311C44.0311 32.1793 44.181 28.2747 44.187 28.0901H46.2003C46.2193 28.2628 46.6683 32.1793 46.6683 32.1793H48.2916L47.5424 26.0678V25.9936V25.9193V25.8451L47.5269 25.7709V25.6966L47.5114 25.6372V25.5629L47.496 25.5034L47.4805 25.4292L47.465 25.3697L47.4495 25.3103L47.434 25.2508L47.4185 25.1913L47.3871 25.1318L47.3716 25.0723L47.3561 25.0129L47.3246 24.9534L47.2932 24.9087L47.2617 24.8492L47.2462 24.8045L47.2148 24.745L47.1833 24.7003L47.1363 24.6555L47.1049 24.5961L47.0734 24.5661L47.0265 24.5066L46.995 24.4766L46.948 24.4319L46.9011 24.3872L46.8541 24.3572L46.8227 24.3125L46.7602 24.2677C46.3547 23.9642 45.8048 23.8214 45.106 23.8214H42.72V23.8224ZM44.2654 25.2051H44.8428C45.2608 25.2051 45.542 25.3331 45.7168 25.5767C45.8607 25.7789 45.9571 26.1653 46.0135 26.7068H44.2184V26.6921V26.6773V26.6626V26.6478V26.6331V26.6183V26.6036V26.5588V26.5141V26.4694L44.2339 26.4247V26.3652V26.3205V26.261V26.2015V26.142V26.0825V25.9488V25.8299L44.2494 25.7704V25.7109V25.6514V25.592V25.5325V25.4878V25.4283V25.3836V25.3388L44.2649 25.3088V25.2941V25.2793V25.2646V25.2499V25.2351V25.2203V25.2051H44.2654Z" fill="white"/></svg></span>\
          <div class="map__point_block">\
            <div class="map__point_top">\
              <div class="map__point_head">Почтовое отделение № 119285</div>\
              <p class="map__point_desc">г Москва, ул Мосфильмовская, дом 34, индекс 438232</p>\
            </div>\
            <div class="map__point_bottom">\
            <p class="map__point_heading">График работы</p>\
              <div class="map__point_times">\
                <p class="map__point_time"><span>пн-пт</span> <span>08:00–20:00</span></p>\
                <p class="map__point_time"><span>сб</span> <span>09:00–20:00</span></p>\
                <p class="map__point_time"><span>вс</span> <span>10:00–18:00</span></p>\
              </div>\
            </div>\
          </div>\
        </div>',
        "latitude": 55.710839,
        "longitude": 37.605068,
        },
      ],
    };

    var mapCoordinates = new ymaps.GeoObjectCollection();

    var results = [];
    data.points.forEach(function(item, index){
      results.push(createPlacemark(item));
    });
    myMap.geoObjects.add(mapCoordinates);

    function createPlacemark(item) {
      var options = Object();
      var squareLayout = ymaps.templateLayoutFactory.createClass(item.infoPoint);
      var place = new ymaps.Placemark([item.latitude, item.longitude],{hintContent: false}, {
        iconLayout: squareLayout,
        iconShape: {   
          type: 'Rectangle',
          coordinates: [
            [-55, -50], [30, 50]
          ]
        }
      });
      mapCoordinates.add(place);
    }
    var thatCoordinates;
    mapCoordinates.events.add('click', function (e) {
      var that = e.get('target').properties.get('active');
      mapCoordinates.each(function(item, index){
        item.properties.set('active', false);
        if(e.get('target') == item && !that){
          e.get('target').properties.set('active', true);
          thatCoordinates = e.get('coords');
        }
      });
      const ordermapblock = document.querySelector('.order__map_block');
      if (document.getElementById('map__point_1').classList.contains("map__active")) {
        ordermapblock.classList.add('active');
        ordermapblock.children[0].innerHTML = document.getElementById('map__point_1').children[1].innerHTML;
      } else {
        ordermapblock.classList.remove('active');
      };
    });
  }
  if (ymaps != undefined) ymaps.ready(init);
}
// end map